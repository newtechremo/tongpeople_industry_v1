# 최초 위험성평가 상세보기 (작업기간중) - 기획 문서

> **원본**: `C:\hongtong\reference\figma\위험성평가 PC관리자\현장통 2.0 PC 관리자 -위험성평가 문서 상세보기 및 수시 상세보기에서 추가 화면.mp4`
> **생성일**: 2026-01-16
> **플랫폼**: PC (admin-web)
> **문서 유형**: 기획 문서 (1단계)
> **구간**: 프레임 010-015 (최초 위험성평가 작업기간중 상태)

---

## 1. 화면 개요

### 1.1 목적
작업이 진행 중인 최초 위험성평가 문서의 상세 내용을 조회하고, 결재 라인 수정 및 출력/삭제를 할 수 있는 화면.

### 1.2 진입 경로
- 위험성평가 목록 → 작업기간중 상태의 최초 위험성평가 문서 클릭

### 1.3 URL 패턴
```
/risk-assessment/initial/{assessmentId}?status=in_progress
```

---

## 2. 화면 구성

### 2.1 레이아웃 구조

```
┌─────────────────────────────────────────────────────────────┐
│ 헤더                                                         │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [최초] 작업명        [작업기간중]  [출력▼] [삭제] [수정]│ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 기본 정보                                                    │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 평가일자: 2026-01-15 ~ 2026-01-20                       │ │
│ │ 작성자: 홍길동 / 협력사: (주)통하는사람들                │ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 결재 라인 (수정 가능)                                        │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [결재자1] → [결재자2] → [결재자3] → ... [✏️] (스크롤)   │ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 위험요인 목록                                                │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 소분류: 탈락                                             │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ 위험요인 카드 1                         [위험등급]  │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. 작업종료 상태와의 차이점

| 항목 | 작업종료 | 작업기간중 |
|------|----------|------------|
| 상태 뱃지 | 회색 `작업종료` | 주황색 `작업기간중` |
| 수정 버튼 | 없음 | **있음** |
| 결재 라인 | 읽기 전용 | **수정 가능** (연필 아이콘) |
| 삭제 | 가능 | 가능 |
| 출력 | 가능 | 가능 |

---

## 4. 상세 UI 요소

### 4.1 헤더 영역

| 요소 | 설명 |
|------|------|
| 평가 유형 | `[최초]` 태그 |
| 작업명 | 위험성평가 문서 제목 |
| 상태 뱃지 | `작업기간중` (주황색 배경, 흰색 텍스트) |
| 출력 버튼 | 드롭다운 메뉴 |
| 삭제 버튼 | 삭제 확인 모달 |
| **수정 버튼** | 수정 페이지로 이동 |

### 4.2 결재 라인 (수정 가능)

```
┌─────────────────────────────────────────────────────────────┐
│ 결재 라인                                            [✏️]   │
│ ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐          │
│ │ 👤   │→│ 👤   │→│ 👤   │→│ 👤   │→│ 👤   │  ...       │
│ │홍길동│  │김철수│  │이영희│  │박지성│  │최민수│          │
│ │과장  │  │대리  │  │부장  │  │차장  │  │사원  │          │
│ │[✓]   │  │[✓]   │  │[⏳]  │  │[⏳]  │  │[⏳]  │          │
│ └──────┘  └──────┘  └──────┘  └──────┘  └──────┘          │
│                                      ← 수평 스크롤 →        │
└─────────────────────────────────────────────────────────────┘
```

| 항목 | 설명 |
|------|------|
| 수정 아이콘 | 연필 아이콘 (✏️) - 클릭 시 결재자 수정 모달 |
| 결재 상태 | ✓ 완료, ⏳ 대기, ✗ 반려 |

### 4.3 위험요인 카드

작업종료 상태와 동일한 구조로 표시.

---

## 5. 모달 정의

### 5.1 결재자 수정 모달

**트리거**: 결재 라인의 수정 아이콘(✏️) 클릭 시

```
┌─────────────────────────────────────────────────────────────┐
│ 결재자 수정                                           [✕]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 현재 결재 라인:                                             │
│ ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐                    │
│ │홍길동│→│김철수│→│이영희│→│ [+] │                    │
│ │ [✗] │  │ [✗] │  │ [✗] │  │     │                    │
│ └──────┘  └──────┘  └──────┘  └──────┘                    │
│                                                             │
│ 결재자 검색:                                                │
│ ┌─────────────────────────────────────┐                    │
│ │ 🔍 이름으로 검색                     │                    │
│ └─────────────────────────────────────┘                    │
│                                                             │
│ 검색 결과:                                                  │
│ ┌─────────────────────────────────────┐                    │
│ │ 👤 박지성 (차장)                     │                    │
│ │ 👤 최민수 (사원)                     │                    │
│ └─────────────────────────────────────┘                    │
│                                                             │
│              [취소]            [저장]                       │
└─────────────────────────────────────────────────────────────┘
```

---

## 6. 사용자 시나리오

### 시나리오 1: 작업기간중 위험성평가 조회

1. 사용자가 위험성평가 목록에서 `작업기간중` 상태의 문서 클릭
2. 상세보기 화면 진입
3. 헤더에 `[최초] 작업명` 및 `작업기간중` 뱃지 표시
4. 결재 라인에 수정 아이콘(✏️) 표시됨
5. 수정 버튼 활성화됨

### 시나리오 2: 결재자 수정

1. 결재 라인의 수정 아이콘(✏️) 클릭
2. 결재자 수정 모달 표시
3. 기존 결재자 삭제 또는 새 결재자 추가
4. 저장 버튼 클릭
5. 결재 라인 업데이트됨

### 시나리오 3: 문서 수정

1. 수정 버튼 클릭
2. 수정 페이지로 이동
3. 내용 수정 후 저장
4. 상세보기 페이지로 복귀

---

## 7. 비즈니스 로직

### 7.1 상태별 권한

| 상태 | 조회 | 출력 | 수정 | 삭제 | 결재라인 수정 |
|------|:----:|:----:|:----:|:----:|:-------------:|
| 작업기간중 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 작업종료 | ✅ | ✅ | ❌ | ✅ | ❌ |

### 7.2 결재자 수정 규칙

- 이미 결재 완료된 결재자는 삭제 불가
- 결재 대기 중인 결재자만 삭제/변경 가능
- 최소 1명의 결재자는 필수

---

## 8. API 엔드포인트

### 8.1 상세 조회

```
GET /api/risk-assessments/initial/{id}
```

### 8.2 결재자 수정

```
PUT /api/risk-assessments/initial/{id}/approvers
Body: {
  approvers: [
    { userId: "user1", order: 1 },
    { userId: "user2", order: 2 }
  ]
}
```

### 8.3 결재자 검색

```
GET /api/users/search?q={keyword}&role=approver
```

---

## 9. 참고 프레임

| 프레임 | 설명 |
|--------|------|
| frame_010 | 최초 위험성평가 상세보기 (작업기간중, 결재라인 수정 아이콘) |
| frame_011-012 | 소분류별 위험요인 카드 |
| frame_013-014 | 출력 버튼 클릭 및 드롭다운 |
| frame_015 | 목록 화면으로 복귀 |

---

## 10. 연결 문서

- 구현 명세서: `docs/ui-specs/pc/specs/2026-01-16-최초위험성평가상세보기-작업기간중-구현.md`
- 작업종료 상태: `docs/ui-specs/pc/plans/2026-01-16-최초위험성평가상세보기-작업종료-기획.md`

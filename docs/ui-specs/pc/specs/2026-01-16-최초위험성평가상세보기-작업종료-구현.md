# ìµœì´ˆ ìœ„í—˜ì„±í‰ê°€ ìƒì„¸ë³´ê¸° (ì‘ì—…ì¢…ë£Œ) - êµ¬í˜„ ëª…ì„¸ì„œ

> **ì›ë³¸**: `C:\hongtong\reference\figma\ìœ„í—˜ì„±í‰ê°€ PCê´€ë¦¬ì\í˜„ì¥í†µ 2.0 PC ê´€ë¦¬ì -ìœ„í—˜ì„±í‰ê°€ ë¬¸ì„œ ìƒì„¸ë³´ê¸° ë° ìˆ˜ì‹œ ìƒì„¸ë³´ê¸°ì—ì„œ ì¶”ê°€ í™”ë©´.mp4`
> **ìƒì„±ì¼**: 2026-01-16
> **í”Œë«í¼**: PC (admin-web)
> **ë¬¸ì„œ ìœ í˜•**: êµ¬í˜„ ëª…ì„¸ì„œ (2ë‹¨ê³„)
> **ê¸°íš ë¬¸ì„œ**: `docs/ui-specs/pc/plans/2026-01-16-ìµœì´ˆìœ„í—˜ì„±í‰ê°€ìƒì„¸ë³´ê¸°-ì‘ì—…ì¢…ë£Œ-ê¸°íš.md`

---

## 1. ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

### 1.1 íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ risk-assessment/
â”‚       â””â”€â”€ InitialAssessmentDetailPage.tsx    # ë©”ì¸ í˜ì´ì§€
â”œâ”€â”€ components/
â”‚   â””â”€â”€ risk-assessment/
â”‚       â””â”€â”€ detail/
â”‚           â”œâ”€â”€ AssessmentDetailHeader.tsx     # í—¤ë” (ì œëª©, ìƒíƒœ, ë²„íŠ¼)
â”‚           â”œâ”€â”€ AssessmentBasicInfo.tsx        # ê¸°ë³¸ ì •ë³´
â”‚           â”œâ”€â”€ ApprovalLineReadonly.tsx       # ê²°ì¬ ë¼ì¸ (ì½ê¸° ì „ìš©)
â”‚           â”œâ”€â”€ RiskFactorCardList.tsx         # ìœ„í—˜ìš”ì¸ ì¹´ë“œ ëª©ë¡
â”‚           â”œâ”€â”€ RiskFactorCard.tsx             # ìœ„í—˜ìš”ì¸ ì¹´ë“œ
â”‚           â”œâ”€â”€ ExportDropdown.tsx             # ì¶œë ¥ ë“œë¡­ë‹¤ìš´
â”‚           â”œâ”€â”€ DeleteConfirmModal.tsx         # ì‚­ì œ í™•ì¸ ëª¨ë‹¬
â”‚           â””â”€â”€ NoPermissionModal.tsx          # ê¶Œí•œ ì—†ìŒ ëª¨ë‹¬
â””â”€â”€ hooks/
    â””â”€â”€ risk-assessment/
        â””â”€â”€ useInitialAssessmentDetail.ts      # ìƒì„¸ ì¡°íšŒ í›…
```

### 1.2 ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬

```
InitialAssessmentDetailPage
â”œâ”€â”€ AssessmentDetailHeader
â”‚   â”œâ”€â”€ ExportDropdown
â”‚   â””â”€â”€ DeleteButton
â”œâ”€â”€ AssessmentBasicInfo
â”œâ”€â”€ ApprovalLineReadonly
â”‚   â””â”€â”€ ApproverCard (ì½ê¸° ì „ìš©)
â”œâ”€â”€ RiskFactorCardList
â”‚   â””â”€â”€ RiskFactorCard[]
â”œâ”€â”€ DeleteConfirmModal
â””â”€â”€ NoPermissionModal
```

---

## 2. ì»´í¬ë„ŒíŠ¸ ë§¤í•‘

### 2.1 ë§¤í•‘ ê²°ê³¼ ìš”ì•½

| ìƒíƒœ | ê°œìˆ˜ |
|------|------|
| âœ… ê¸°ì¡´ ì‚¬ìš© | 4ê°œ |
| ğŸ†• ì‹ ê·œ í•„ìš” | 8ê°œ |
| âš ï¸ ìˆ˜ì • í•„ìš” | 0ê°œ |

### 2.2 ìƒì„¸ ë§¤í•‘

| UI ìš”ì†Œ | ìƒíƒœ | ì»´í¬ë„ŒíŠ¸ | ê²½ë¡œ |
|---------|------|----------|------|
| í˜ì´ì§€ ë ˆì´ì•„ì›ƒ | âœ… | ê¸°ì¡´ Layout | `src/App.tsx` |
| ì‚¬ì´ë“œë°” | âœ… | `Sidebar` | `src/components/Sidebar.tsx` |
| í—¤ë” | âœ… | `Header` | `src/components/Header.tsx` |
| ì•„ì´ì½˜ (lucide) | âœ… | ChevronLeft, Download, Trash2 ë“± | `lucide-react` |
| ìƒì„¸ í˜ì´ì§€ | ğŸ†• | `InitialAssessmentDetailPage` | - |
| ìƒì„¸ í—¤ë” | ğŸ†• | `AssessmentDetailHeader` | - |
| ê¸°ë³¸ ì •ë³´ | ğŸ†• | `AssessmentBasicInfo` | - |
| ê²°ì¬ ë¼ì¸ (ì½ê¸°) | ğŸ†• | `ApprovalLineReadonly` | - |
| ìœ„í—˜ìš”ì¸ ì¹´ë“œ ëª©ë¡ | ğŸ†• | `RiskFactorCardList` | - |
| ìœ„í—˜ìš”ì¸ ì¹´ë“œ | ğŸ†• | `RiskFactorCard` | - |
| ì¶œë ¥ ë“œë¡­ë‹¤ìš´ | ğŸ†• | `ExportDropdown` | - |
| ì‚­ì œ í™•ì¸ ëª¨ë‹¬ | ğŸ†• | `DeleteConfirmModal` | - |
| ê¶Œí•œ ì—†ìŒ ëª¨ë‹¬ | ğŸ†• | `NoPermissionModal` | - |

---

## 3. ì»´í¬ë„ŒíŠ¸ ëª…ì„¸

### 3.1 InitialAssessmentDetailPage

**íŒŒì¼**: `src/pages/risk-assessment/InitialAssessmentDetailPage.tsx`

```tsx
interface InitialAssessmentDetailPageProps {
  // URL paramsì—ì„œ ì¶”ì¶œ
}

// ë¼ìš°íŠ¸: /risk-assessment/initial/:id
```

**ì£¼ìš” ë¡œì§**:
- URLì—ì„œ `id` ì¶”ì¶œ
- `useInitialAssessmentDetail` í›…ìœ¼ë¡œ ë°ì´í„° ì¡°íšŒ
- ìƒíƒœì— ë”°ë¥¸ UI ë¶„ê¸° (ì‘ì—…ì¢…ë£Œ vs ì‘ì—…ê¸°ê°„ì¤‘)

### 3.2 AssessmentDetailHeader

**íŒŒì¼**: `src/components/risk-assessment/detail/AssessmentDetailHeader.tsx`

```tsx
interface AssessmentDetailHeaderProps {
  assessmentType: 'initial' | 'adhoc';
  title: string;
  status: 'in_progress' | 'completed';
  onExport: (format: 'pdf' | 'excel') => void;
  onDelete: () => void;
  canEdit: boolean;
}
```

**ìŠ¤íƒ€ì¼ë§**:
```tsx
// í—¤ë” ì»¨í…Œì´ë„ˆ
className="flex items-center justify-between py-4 border-b border-gray-200"

// í‰ê°€ ìœ í˜• íƒœê·¸
className="px-2 py-1 text-sm font-medium rounded bg-gray-100 text-gray-700"

// ìƒíƒœ ë±ƒì§€ - ì‘ì—…ì¢…ë£Œ
className="px-3 py-1 text-sm font-medium rounded-full bg-gray-500 text-white"

// ë²„íŠ¼ ê·¸ë£¹
className="flex items-center gap-2"
```

### 3.3 ExportDropdown

**íŒŒì¼**: `src/components/risk-assessment/detail/ExportDropdown.tsx`

```tsx
interface ExportDropdownProps {
  onExport: (format: 'pdf' | 'excel') => void;
}

const exportOptions = [
  { label: 'PDFë¡œ ì €ì¥', value: 'pdf' },
  { label: 'Excelë¡œ ì €ì¥', value: 'excel' },
];
```

**ìŠ¤íƒ€ì¼ë§**:
```tsx
// ë“œë¡­ë‹¤ìš´ ë²„íŠ¼
className="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-1"

// ë“œë¡­ë‹¤ìš´ ë©”ë‰´
className="absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-10"

// ë©”ë‰´ ì•„ì´í…œ
className="px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer"
```

### 3.4 ApprovalLineReadonly

**íŒŒì¼**: `src/components/risk-assessment/detail/ApprovalLineReadonly.tsx`

```tsx
interface ApprovalLineReadonlyProps {
  approvers: Approver[];
}

interface Approver {
  id: string;
  name: string;
  position: string;
  profileImage?: string;
  status: 'pending' | 'approved' | 'rejected';
  approvedAt?: string;
}
```

**ìŠ¤íƒ€ì¼ë§**:
```tsx
// ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ
className="flex gap-4 overflow-x-auto py-4 px-2"

// ê²°ì¬ì ì¹´ë“œ
className="flex-shrink-0 flex flex-col items-center p-4 bg-white border border-gray-200 rounded-xl min-w-[120px]"

// ê²°ì¬ ìƒíƒœ ì•„ì´ì½˜ - ì™„ë£Œ
className="w-6 h-6 text-green-500"

// ê²°ì¬ ìƒíƒœ ì•„ì´ì½˜ - ëŒ€ê¸°
className="w-6 h-6 text-gray-400"
```

### 3.5 RiskFactorCard

**íŒŒì¼**: `src/components/risk-assessment/detail/RiskFactorCard.tsx`

```tsx
interface RiskFactorCardProps {
  subCategory: string;
  riskFactor: string;
  currentMeasures: string;
  riskLevel: 'low' | 'medium' | 'high';
}
```

**ìŠ¤íƒ€ì¼ë§**:
```tsx
// ì¹´ë“œ ì»¨í…Œì´ë„ˆ
className="p-6 bg-white border border-gray-200 rounded-xl"

// ì†Œë¶„ë¥˜ ì œëª©
className="text-sm font-medium text-gray-500 mb-4"

// ìœ„í—˜ìš”ì¸ í…ìŠ¤íŠ¸
className="text-base text-gray-900 mb-4"

// ìœ„í—˜ì„± ìˆ˜ì¤€ ë±ƒì§€ - í•˜
className="px-3 py-1 text-sm font-medium rounded-full bg-green-100 text-green-700"

// ìœ„í—˜ì„± ìˆ˜ì¤€ ë±ƒì§€ - ì¤‘
className="px-3 py-1 text-sm font-medium rounded-full bg-yellow-100 text-yellow-700"

// ìœ„í—˜ì„± ìˆ˜ì¤€ ë±ƒì§€ - ìƒ
className="px-3 py-1 text-sm font-medium rounded-full bg-red-100 text-red-700"
```

### 3.6 DeleteConfirmModal

**íŒŒì¼**: `src/components/risk-assessment/detail/DeleteConfirmModal.tsx`

```tsx
interface DeleteConfirmModalProps {
  isOpen: boolean;
  onClose: () => void;
  onConfirm: () => void;
  isLoading?: boolean;
}
```

**ìŠ¤íƒ€ì¼ë§**:
```tsx
// ëª¨ë‹¬ ì˜¤ë²„ë ˆì´
className="fixed inset-0 bg-black/50 flex items-center justify-center z-50"

// ëª¨ë‹¬ ì»¨í…Œì´ë„ˆ
className="bg-white rounded-2xl p-8 max-w-md w-full mx-4"

// ì œëª©
className="text-xl font-bold text-gray-900 text-center mb-4"

// ë©”ì‹œì§€
className="text-gray-600 text-center mb-8"

// ë²„íŠ¼ ê·¸ë£¹
className="flex gap-3"

// ì·¨ì†Œ ë²„íŠ¼
className="flex-1 px-4 py-3 text-gray-700 bg-gray-100 rounded-xl font-medium hover:bg-gray-200"

// ì‚­ì œ ë²„íŠ¼
className="flex-1 px-4 py-3 text-white bg-red-500 rounded-xl font-medium hover:bg-red-600"
```

### 3.7 NoPermissionModal

**íŒŒì¼**: `src/components/risk-assessment/detail/NoPermissionModal.tsx`

```tsx
interface NoPermissionModalProps {
  isOpen: boolean;
  onClose: () => void;
  message?: string;
}
```

**ìŠ¤íƒ€ì¼ë§**:
```tsx
// ëª¨ë‹¬ ì»¨í…Œì´ë„ˆ
className="bg-white rounded-2xl p-8 max-w-sm w-full mx-4 text-center"

// ë©”ì‹œì§€
className="text-lg text-gray-900 mb-6"

// í™•ì¸ ë²„íŠ¼
className="px-8 py-3 text-white bg-gray-800 rounded-xl font-medium"
```

---

## 4. ìƒíƒœ ê´€ë¦¬

### 4.1 ì»¤ìŠ¤í…€ í›…

**íŒŒì¼**: `src/hooks/risk-assessment/useInitialAssessmentDetail.ts`

```tsx
interface UseInitialAssessmentDetailReturn {
  data: InitialAssessmentDetail | null;
  isLoading: boolean;
  error: Error | null;
  deleteAssessment: () => Promise<void>;
  exportAssessment: (format: 'pdf' | 'excel') => Promise<void>;
}

function useInitialAssessmentDetail(id: string): UseInitialAssessmentDetailReturn {
  // React Query ì‚¬ìš©
  const { data, isLoading, error } = useQuery({
    queryKey: ['initial-assessment', id],
    queryFn: () => fetchInitialAssessmentDetail(id),
  });

  const deleteMutation = useMutation({
    mutationFn: () => deleteInitialAssessment(id),
    onSuccess: () => {
      // ëª©ë¡ìœ¼ë¡œ ì´ë™
      navigate('/risk-assessment');
    },
  });

  // ...
}
```

### 4.2 ë°ì´í„° íƒ€ì…

```tsx
interface InitialAssessmentDetail {
  id: string;
  title: string;
  status: 'in_progress' | 'completed';
  assessmentType: 'initial';
  startDate: string;
  endDate: string;
  createdBy: {
    id: string;
    name: string;
    company: string;
  };
  approvers: Approver[];
  riskFactors: RiskFactorGroup[];
}

interface RiskFactorGroup {
  subCategory: string;
  items: RiskFactorItem[];
}

interface RiskFactorItem {
  id: string;
  riskFactor: string;
  currentMeasures: string;
  riskLevel: 'low' | 'medium' | 'high';
}
```

---

## 5. API ì—°ë™

### 5.1 ìƒì„¸ ì¡°íšŒ

```
GET /api/risk-assessments/initial/{id}
```

**Response Schema:**
```tsx
interface InitialAssessmentDetailResponse {
  id: string;
  title: string;
  status: 'in_progress' | 'completed';
  assessmentType: 'initial';
  startDate: string;              // ISO 8601 (YYYY-MM-DD)
  endDate: string;                // ISO 8601 (YYYY-MM-DD)
  createdBy: {
    id: string;
    name: string;
    company: string;
  };
  approvers: {
    id: string;
    name: string;
    position: string;
    profileImage?: string;
    status: 'pending' | 'approved' | 'rejected';
    approvedAt?: string;          // ISO 8601
  }[];
  riskFactors: {
    subCategory: string;
    items: {
      id: string;
      riskFactor: string;
      currentMeasures: string;
      riskLevel: 'low' | 'medium' | 'high';
    }[];
  }[];
  createdAt: string;              // ISO 8601
  updatedAt: string;              // ISO 8601
}
```

**í´ë¼ì´ì–¸íŠ¸ í•¨ìˆ˜:**
```tsx
async function fetchInitialAssessmentDetail(id: string): Promise<InitialAssessmentDetailResponse> {
  const response = await apiClient.get(`/risk-assessments/initial/${id}`);
  return response.data;
}
```

### 5.2 ì‚­ì œ

```
DELETE /api/risk-assessments/initial/{id}
```

**Response:** `204 No Content`

**í´ë¼ì´ì–¸íŠ¸ í•¨ìˆ˜:**
```tsx
async function deleteInitialAssessment(id: string): Promise<void> {
  await apiClient.delete(`/risk-assessments/initial/${id}`);
}
```

### 5.3 ì¶œë ¥ (ë‹¤ìš´ë¡œë“œ)

```
GET /api/risk-assessments/initial/{id}/export?format={pdf|excel}
```

**Query Parameters:**
| íŒŒë¼ë¯¸í„° | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|----------|------|:----:|------|
| format | string | âœ… | `pdf` ë˜ëŠ” `excel` |

**Response:** `application/octet-stream` (íŒŒì¼ ë°”ì´ë„ˆë¦¬)

**Response Headers:**
```
Content-Type: application/pdf | application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
Content-Disposition: attachment; filename="ìœ„í—˜ì„±í‰ê°€_{id}.{pdf|xlsx}"
```

**í´ë¼ì´ì–¸íŠ¸ í•¨ìˆ˜:**
```tsx
async function exportAssessment(id: string, format: 'pdf' | 'excel'): Promise<void> {
  const response = await apiClient.get(
    `/risk-assessments/initial/${id}/export`,
    {
      params: { format },
      responseType: 'blob',
    }
  );

  const url = window.URL.createObjectURL(response.data);
  const link = document.createElement('a');
  link.href = url;
  link.download = `ìœ„í—˜ì„±í‰ê°€_${id}.${format === 'pdf' ? 'pdf' : 'xlsx'}`;
  link.click();
  window.URL.revokeObjectURL(url);
}
```

---

## 6. êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 6.1 ì»´í¬ë„ŒíŠ¸

- [ ] InitialAssessmentDetailPage
- [ ] AssessmentDetailHeader
- [ ] AssessmentBasicInfo
- [ ] ApprovalLineReadonly
- [ ] RiskFactorCardList
- [ ] RiskFactorCard
- [ ] ExportDropdown
- [ ] DeleteConfirmModal
- [ ] NoPermissionModal

### 6.2 í›… ë° API

- [ ] useInitialAssessmentDetail
- [ ] fetchInitialAssessmentDetail
- [ ] deleteInitialAssessment
- [ ] exportAssessment

### 6.3 ë¼ìš°íŒ…

- [ ] `/risk-assessment/initial/:id` ë¼ìš°íŠ¸ ì¶”ê°€

---

## 7. ì—°ê²° ë¬¸ì„œ

- ê¸°íš ë¬¸ì„œ: `docs/ui-specs/pc/plans/2026-01-16-ìµœì´ˆìœ„í—˜ì„±í‰ê°€ìƒì„¸ë³´ê¸°-ì‘ì—…ì¢…ë£Œ-ê¸°íš.md`

---

## 8. ÀÛ¾÷Á¾·á »óÅÂ Ãß°¡ ±ÔÄ¢

- ¼öÁ¤ ºÒ°¡: ±âº»Á¤º¸/ÀÛ¾÷±â°£/¼¼ºÎ Ç×¸ñ/°áÀç¶óÀÎ ÀüºÎ ÀĞ±â Àü¿ë
- Çì´õ ¹öÆ°: Ãâ·Â/»èÁ¦ + **ÀçÀÛ¼º** ¹öÆ° Ãß°¡

### ÀçÀÛ¼º ¹öÆ° µ¿ÀÛ
- ±âÁ¸ ¹®¼­¸¦ º¹»çÇØ "ÃÖÃÊ À§Çè¼ºÆò°¡ ¸¸µé±â"·Î ÀÌµ¿
- ÀÛ¾÷±â°£/°áÀç¶óÀÎ/¼¼ºÎ Ç×¸ñÀº º¹»çµÈ »óÅÂ·Î ÁøÀÔ
- ÀúÀå ½Ã ½Å±Ô ¹®¼­·Î »ı¼º

### Çì´õ Props º¯°æ Á¦¾È
```tsx
interface AssessmentDetailHeaderProps {
  assessmentType: 'initial' | 'adhoc';
  title: string;
  status: 'pre_start' | 'in_progress' | 'completed';
  onExport: (format: 'pdf' | 'excel') => void;
  onDelete: () => void;
  onEdit?: () => void;
  onRewrite?: () => void; // ÀÛ¾÷Á¾·á Àü¿ë
  canEdit: boolean;
  canRewrite: boolean;
}
```

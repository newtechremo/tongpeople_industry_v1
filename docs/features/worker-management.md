# 근로자 관리 기능 명세서

> 최종 업데이트: 2026-01-02

## 개요

**대규모 인원 관리**를 위한 필터형 마스터 테이블 디자인입니다.
- 이 프로젝트에서 **'팀'과 '소속업체'는 동일한 개념**입니다.
- 강력한 필터 기능과 페이지네이션으로 대량의 근로자 데이터를 효율적으로 관리합니다.

---

## 1. 주요 UI 구성

### 1.1 상단 요약 배너 (유지)

기본 대시보드 수치로 현장의 전체 흐름을 한눈에 파악합니다.
**필터 결과에 동기화**되어 필터링된 데이터의 통계를 보여줍니다.

| 카드 | 설명 | 상태 |
|------|------|------|
| 전체 근로자 | 필터된 총 근로자 수 | ✅ 완료 |
| 활성 근로자 | 필터된 활성 상태 근로자 수 | ✅ 완료 |
| 금일 출근 | 필터된 오늘 출근 근로자 수 | ✅ 완료 |
| 고령 근로자 | 필터된 65세 이상 근로자 수 | ✅ 완료 |

### 1.2 파워 필터 바 (New)

카드뷰 대신 인원을 좁혀낼 수 있는 강력한 필터 라인을 구성합니다.

| 필터 | 타입 | 설명 | 상태 |
|------|------|------|------|
| 검색창 | Text | 이름, 연락처 검색 | ✅ 완료 |
| 팀(업체) 필터 | Dropdown | 전체 또는 특정 팀 선택 | ✅ 완료 |
| 역할 필터 | Dropdown | 팀 관리자, 일반 근로자, 근로자 대표 | ✅ 완료 |
| 상태 필터 | Dropdown | 출근 중, 미출근, 퇴근, 승인대기, 비활성 | ✅ 완료 |
| 필터 초기화 | Button | 모든 필터 리셋 | ✅ 완료 |
| 팀별 묶기 토글 | Toggle | 마스터 테이블 ↔ 그룹 뷰 전환 | ✅ 완료 |

### 1.3 마스터 테이블 그리드

인원이 많아도 가독성을 유지할 수 있도록 열(Column)을 최적화합니다.

| 컬럼 | 설명 | 상태 |
|------|------|------|
| 체크박스 | 일괄 선택용 | ✅ 완료 |
| 소속 팀(업체) | 팀명 표시 (정렬 가능) | ✅ 완료 |
| 이름 | 👑 리더 아이콘, [고령], [대표] 태그 | ✅ 완료 |
| 연락처 | 클릭 시 전화 연결 | ✅ 완료 |
| 직종 | 전기기사, 일반근로자 등 | ✅ 완료 |
| 나이 | 고령자는 강조 표시 | ✅ 완료 |
| 상태 | 출근중/퇴근/미출근/승인대기/비활성 | ✅ 완료 |
| 관리 | 상세보기 버튼 | ✅ 완료 |

### 1.4 디자인 개선 포인트 (UX)

#### ① 팀별 묶어보기 토글

| 기능 | 설명 | 상태 |
|------|------|------|
| 토글 스위치 | 테이블 상단에 배치 | ✅ 완료 |
| 토글 ON | 기존의 카드뷰(아코디언 그룹화) | ✅ 완료 |
| 토글 OFF | 전체 인원 마스터 테이블 | ✅ 완료 |

#### ② 페이지네이션

| 기능 | 설명 | 상태 |
|------|------|------|
| 페이지 단위 | 10명씩 표시 | ✅ 완료 |
| 페이지 이동 | 이전/다음 버튼 | ✅ 완료 |
| 현재 표시 범위 | "총 12명 중 1-10명 표시" | ✅ 완료 |

#### ③ 일괄 편집 기능 (Bulk Action)

| 기능 | 설명 | 상태 |
|------|------|------|
| 체크박스 선택 | 여러 명 선택 가능 | ✅ 완료 |
| 선택 표시바 | "N명 선택됨" 표시 | ✅ 완료 |
| 팀 변경 | 선택된 인원 팀 일괄 변경 | ⬜ UI만 완료 |
| 일괄 퇴근 처리 | 선택된 인원 퇴근 일괄 처리 | ⬜ UI만 완료 |
| 비활성화 | 선택된 인원 일괄 비활성화 | ⬜ UI만 완료 |
| 전체 선택/해제 | 헤더 체크박스 | ✅ 완료 |

---

## 2. 정렬 로직

기본 정렬 순서:
1. **팀명** (가나다순)
2. **역할** (리더 우선)
3. **이름** (가나다순)

---

## 3. 통계 동기화

필터를 걸었을 때 상단 요약 배너의 숫자도 **필터링된 결과값**에 맞춰 변합니다.

예시:
- 전체: 12명 → B업체만 필터 시: 4명
- 활성: 10명 → B업체만 필터 시: 3명

---

## 4. 근로자 추가 (신규 동의링크)

### 4.1 팝업 입력 항목

| 항목 | 타입 | 필수 | 설명 | 상태 |
|------|------|:----:|------|------|
| 소속 팀 | Dropdown | O | 사전 등록된 팀(업체) 리스트 | ✅ 완료 |
| 이름 | Text | O | 실명 입력 | ✅ 완료 |
| 휴대폰 번호 | Tel | O | 동의 링크 발송용 | ✅ 완료 |
| 생년월일 | Number(8자) | O | 만 65세 자동 판별 | ✅ 완료 |
| 직책/직종 | Select | O | 공사기사, 안전관리자, 일반근로자 등 | ✅ 완료 |
| 시스템 권한 | Radio | O | 팀 관리자(QR 리더) vs 일반 근로자 | ✅ 완료 |
| 국적 | Select | - | 기본값: 대한민국 | ✅ 완료 |
| 성별 | Toggle | - | 기본값: 남성 | ✅ 완료 |

### 4.2 추가 후 프로세스

1. 입력 정보 저장
2. 휴대폰으로 동의 링크 문자 발송
3. 근로자 상태: `PENDING` (승인대기)
4. 근로자가 링크에서 승인 시 → `ACTIVE` (활성)

> **[추후 구현]** 문자 발송 및 승인 상태 체크 기능

---

## 5. 근로자 상세 정보 (Drawer)

### 5.1 프로필 헤더

| 요소 | 설명 | 상태 |
|------|------|------|
| 이름 및 나이 | '김철수 (만 45세)' | ✅ 완료 |
| 역할 태그 | [팀 관리자], [근로자 대표] | ✅ 완료 |
| 출퇴근 상태 | 실시간 아이콘 (출근중/퇴근/미출근) | ✅ 완료 |
| 고령자 경고 | 만 65세 이상 시 주의 문구 표시 | ✅ 완료 |

### 5.2 기본 및 소속 정보

| 항목 | 설명 | 상태 |
|------|------|------|
| 팀(업체) | 소속 팀명 | ✅ 완료 |
| 직책/직종 | 현재 직책 | ✅ 완료 |
| 연락처 | 클릭 시 전화 연결 | ✅ 완료 |
| 생년월일 | YYYY-MM-DD (나이) | ✅ 완료 |
| 국적 | 대한민국 등 | ✅ 완료 |
| 등록일 | 현장 최초 등록일 | ✅ 완료 |

### 5.3 근무 및 안전 현황

| 항목 | 설명 | 상태 |
|------|------|------|
| 누적 근무 | 총 근무 일수 | ✅ 완료 |
| 이번 달 출근 | 월간 출근 횟수 | ✅ 완료 |
| 고령 근로자 경고 | 65세 이상 시 상시 노출 | ✅ 완료 |

### 5.4 채용 서류 (최대 10개)

| 서류 유형 | 코드 | 상태 |
|-----------|------|------|
| 안전관리서약서 | SAFETY_PLEDGE | ✅ 완료 |
| 교육이수및보호구수령확인서 | TRAINING_CERT | ✅ 완료 |
| 개인정보수집이용동의서 | PRIVACY_CONSENT | ✅ 완료 |
| 건강문진표 | HEALTH_QUESTIONNAIRE | ✅ 완료 |
| 기초안전보건교육증 | SAFETY_EDUCATION_CERT | ✅ 완료 |
| 자격증 | LICENSE | ✅ 완료 |
| 기타 | OTHER | ✅ 완료 |

### 5.5 비상연락처

| 항목 | 설명 | 상태 |
|------|------|------|
| 이름 | 비상연락처 대상자 | ✅ 완료 |
| 연락처 | 클릭 시 전화 연결 | ✅ 완료 |
| 관계 | 배우자, 부모, 자녀 등 | ✅ 완료 |

### 5.6 건강정보

| 항목 | 설명 | 상태 |
|------|------|------|
| 혈액형 | A, B, O, AB (Rh+/-) | ✅ 완료 |
| 하루 흡연량 | 개비 수 | ✅ 완료 |
| 1주일 음주횟수 | 횟수 | ✅ 완료 |
| 음주 1회 섭취량 | 예: 소주 1병 | ✅ 완료 |
| 최고혈압 | mmHg | ✅ 완료 |
| 최저혈압 | mmHg | ✅ 완료 |
| 65세 이상 여부 | 예/아니오 | ✅ 완료 |
| 기저질환 여부 | 있음/없음 | ✅ 완료 |

---

## 6. 데이터 모델

### 6.1 Worker (근로자)

```typescript
interface Worker {
  id: string;
  name: string;
  phone: string;
  birthDate: string;
  age?: number;
  isSenior?: boolean;
  siteId: number;
  teamId: number;
  teamName?: string;
  role: UserRole;
  position?: string;
  isRepresentative?: boolean;
  nationality?: string;
  gender?: 'M' | 'F';
  status: WorkerStatus;
  attendanceStatus?: AttendanceStatus;
  totalWorkDays?: number;
  monthlyWorkDays?: number;
  registeredAt?: string;
}
```

### 6.2 Team (팀/업체)

```typescript
interface Team {
  id: number;
  name: string;
  siteId: number;
  leaderId?: string;
  leaderName?: string;
  workerCount?: number;
}
```

---

## 7. 사용자 시나리오

### 시나리오 1: 대규모 인원 필터링

1. 현장에 100명 이상의 근로자가 등록됨
2. 파워 필터 바에서 "B업체(미장팀)" 선택
3. 상단 통계가 B업체 기준으로 변경됨
4. 마스터 테이블에 B업체 인원만 표시
5. 추가로 "출근 중" 상태 필터 적용
6. 현재 출근 중인 B업체 인원만 표시

### 시나리오 2: 일괄 팀 변경

1. 마스터 테이블에서 여러 명 체크박스 선택
2. 상단에 "N명 선택됨" 바 표시
3. [팀 변경] 버튼 클릭
4. 새 팀 선택하여 일괄 변경

### 시나리오 3: 뷰 전환

1. 기본은 마스터 테이블 뷰 (목록형)
2. [팀별 묶기] 토글 ON
3. 아코디언 그룹 뷰로 전환
4. 팀 헤더 클릭하여 펼침/접음

### 시나리오 4: 신규 근로자 등록

1. [신규 동의링크] 버튼 클릭
2. 소속 팀, 이름, 연락처, 생년월일, 직책 입력
3. 시스템 권한 선택 (일반 근로자 / 팀 관리자)
4. [동의링크 발송] 버튼 클릭
5. 근로자에게 문자로 동의 링크 발송
6. 목록에 '승인대기' 상태로 표시

---

## 8. 구현 파일 목록

| 파일 | 설명 |
|------|------|
| `pages/WorkersPage.tsx` | 메인 목록 화면 (필터, 테이블, 그룹뷰) |
| `components/workers/WorkerAddModal.tsx` | 근로자 추가 팝업 |
| `components/workers/WorkerDetailDrawer.tsx` | 상세 정보 Drawer |
| `@tong-pass/shared/types` | Worker, Team 타입 정의 |

---

## 9. 추후 구현 예정

- [ ] 문자 발송 API 연동
- [ ] 승인 상태 실시간 체크
- [ ] 서류 업로드 기능
- [ ] 근로자 수정/삭제 기능
- [ ] 팀 관리 (추가/수정/삭제)
- [ ] 일괄 편집 API 연동 (팀 변경, 퇴근 처리, 비활성화)
- [ ] 무한 스크롤 옵션 (페이지네이션 대안)
- [ ] 팀 필터 검색 기능 (인원이 많을 경우)

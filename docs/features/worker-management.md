# 근로자 관리 기능 명세서

> 최종 업데이트: 2026-01-02

## 개요

**대규모 인원 관리**를 위한 필터형 마스터 테이블 디자인입니다.
- 이 프로젝트에서 **'팀'과 '소속업체'는 동일한 개념**입니다.
- 강력한 필터 기능과 페이지네이션으로 대량의 근로자 데이터를 효율적으로 관리합니다.
- 출퇴근 관련 정보는 별도의 **출퇴근 관리** 페이지에서 관리합니다.

---

## 1. 주요 UI 구성

### 1.1 파워 필터 바

인원을 좁혀낼 수 있는 강력한 필터 라인입니다.

| 필터 | 타입 | 설명 | 상태 |
|------|------|------|------|
| 검색창 | Text | 이름, 연락처 검색 | ✅ 완료 |
| 팀(업체) 필터 | Dropdown | 전체 또는 특정 팀 선택 | ✅ 완료 |
| 역할 필터 | Dropdown | 팀 관리자, 일반 근로자, 근로자 대표 | ✅ 완료 |
| 상태 필터 | Dropdown | 승인대기, 비활성 (활성 제외) | ✅ 완료 |
| 필터 초기화 | Button | 모든 필터 리셋 (항상 표시) | ✅ 완료 |

### 1.2 마스터 테이블 그리드

인원이 많아도 가독성을 유지할 수 있도록 열(Column)을 최적화합니다.

| 컬럼 | 설명 | 상태 |
|------|------|------|
| 체크박스 | 일괄 선택용 | ✅ 완료 |
| 소속 팀(업체) | 팀명 표시 (정렬 가능) | ✅ 완료 |
| 이름 | 👑 리더 아이콘, [고령], [대표] 태그 | ✅ 완료 |
| 연락처 | 클릭 시 전화 연결 | ✅ 완료 |
| 직종 | 전기기사, 일반근로자 등 | ✅ 완료 |
| 나이 | 고령자는 강조 표시 | ✅ 완료 |
| 상태 | 승인대기/비활성 (활성은 미표시) | ✅ 완료 |
| 관리 | 상세보기 버튼 | ✅ 완료 |

### 1.3 페이지네이션

| 기능 | 설명 | 상태 |
|------|------|------|
| 페이지 단위 | 10명씩 표시 | ✅ 완료 |
| 페이지 이동 | 이전/다음 버튼 | ✅ 완료 |
| 현재 표시 범위 | "총 12명 중 1-10명 표시" | ✅ 완료 |

### 1.4 일괄 편집 기능 (Bulk Action)

| 기능 | 설명 | 상태 |
|------|------|------|
| 체크박스 선택 | 여러 명 선택 가능 | ✅ 완료 |
| 선택 표시바 | "N명 선택됨" 표시 | ✅ 완료 |
| 팀 변경 | 선택된 인원 팀 일괄 변경 | ⬜ UI만 완료 |
| 비활성화 | 선택된 인원 일괄 비활성화 | ⬜ UI만 완료 |
| 전체 선택/해제 | 헤더 체크박스 | ✅ 완료 |

---

## 2. 정렬 로직

기본 정렬 순서:
1. **팀명** (가나다순)
2. **역할** (리더 우선)
3. **이름** (가나다순)

---

## 3. 근로자 추가 (신규 동의링크)

### 3.1 팝업 입력 항목

| 항목 | 타입 | 필수 | 설명 | 상태 |
|------|------|:----:|------|------|
| 소속 팀 | Dropdown | O | 사전 등록된 팀(업체) 리스트 | ✅ 완료 |
| 이름 | Text | O | 실명 입력 | ✅ 완료 |
| 휴대폰 번호 | Tel | O | 동의 링크 발송용 | ✅ 완료 |
| 생년월일 | Number(8자) | O | 만 65세 자동 판별 | ✅ 완료 |
| 직책/직종 | Text + Datalist | O | 선택 또는 직접 입력 가능 | ✅ 완료 |
| 시스템 권한 | Radio | O | 팀 관리자(QR 리더) vs 일반 근로자 | ✅ 완료 |
| 국적 | Select | - | 기본값: 대한민국 | ✅ 완료 |
| 성별 | Toggle | - | 기본값: 남성 | ✅ 완료 |

### 3.2 추가 후 프로세스

1. 입력 정보 저장
2. 휴대폰으로 동의 링크 문자 발송
3. 근로자 상태: `PENDING` (승인대기)
4. 근로자가 링크에서 승인 시 → `ACTIVE` (활성)

> **[추후 구현]** 문자 발송 및 승인 상태 체크 기능

---

## 4. 엑셀 일괄 등록

대규모 인원을 효율적으로 등록하기 위한 엑셀 업로드 기능입니다.

### 4.1 엑셀 양식 컬럼

| 컬럼명 | 필수 여부 | 형식 예시 | 설명 |
|--------|:---------:|-----------|------|
| 성명 | 필수 | 홍길동 | 근로자 실명 |
| 휴대폰 번호 | 필수 | 01012345678 | 하이픈(-) 제외 숫자만 입력 |
| 소속 팀(업체) | 필수 | (주)정이앤지 | 시스템에 등록된 팀명과 일치해야 함 |
| 생년월일 | 필수 | 19800101 | 8자리 숫자 (만 65세 고령자 판별용) |
| 역할 | 필수 | 근로자 / 팀 관리자 | '팀 관리자' 입력 시 QR 스캔 권한 부여 |
| 직종 | 선택 | 전기기사 / 미장공 | 현장 실무 직종 |
| 성별 | 선택 | 남성 / 여성 | 미입력 시 '남성' 기본값 |
| 국적 | 선택 | 대한민국 | 미입력 시 '대한민국' 기본값 |

### 4.2 업로드 처리 단계

**Step 1: 파일 파싱 및 기본 유효성 검사**
- 형식 체크: 휴대폰 번호가 숫자인지, 생년월일이 8자리인지 확인
- 필수값 체크: 이름, 번호, 팀명 등 필수 항목이 비어있는 행 확인

**Step 2: 데이터 매핑 및 참조 확인**
- 팀명 매칭: 입력된 '소속 팀' 텍스트가 시스템에 등록된 팀과 일치하는지 확인

**Step 3: 중복 데이터 처리 (Duplicate Check)**
- 고유 키: '휴대폰 번호'를 고유 식별자로 사용하여 중복 확인
- 처리 방식: '기존 정보 업데이트' 또는 '건너뛰기' 옵션 선택

**Step 4: 결과 미리보기 및 최종 승인**
- DB에 바로 넣지 않고, 웹 화면에서 먼저 업로드 결과 표시
- 정상/오류 건수 리포트 제공

### 4.3 UI/UX 기능

| 기능 | 설명 | 상태 |
|------|------|------|
| 양식 다운로드 | 팀 목록이 포함된 엑셀 양식 제공 | ✅ 완료 |
| 드래그 앤 드롭 | 파일을 화면에 끌어다 놓기 | ✅ 완료 |
| 오류 행 하이라이트 | 에러 행 빨간색 표시 | ✅ 완료 |
| 셀 직접 수정 | 오류 셀에서 바로 수정 가능 | ✅ 완료 |
| 재검증 | 수정 후 재검증 버튼 | ✅ 완료 |
| 일괄 초대 발송 | 등록 완료 시 SMS 일괄 발송 | ⬜ API 연동 필요 |

---

## 5. 근로자 상세 정보 (Modal)

중앙 팝업 형태의 상세 정보 모달입니다. (가로형 태블릿 대응)

### 5.1 프로필 헤더

| 요소 | 설명 | 상태 |
|------|------|------|
| 아바타 | 프로필 이미지 또는 기본 아이콘 | ✅ 완료 |
| 이름 및 나이 | '김철수 (만 45세)' | ✅ 완료 |
| 소속 및 직종 | 'A업체(전기팀) · 전기기사' | ✅ 완료 |
| 역할 태그 | [팀 관리자], [근로자 대표], [고령자] | ✅ 완료 |
| 상태 배지 | 승인대기/비활성 (활성은 미표시) | ✅ 완료 |
| 고령자 경고 | 만 65세 이상 시 주의 문구 표시 | ✅ 완료 |

### 5.2 기본 및 소속 정보

| 항목 | 설명 | 상태 |
|------|------|------|
| 팀(업체) | 소속 팀명 | ✅ 완료 |
| 직책/직종 | 현재 직책 | ✅ 완료 |
| 연락처 | 클릭 시 전화 연결 | ✅ 완료 |
| 생년월일 | YYYY-MM-DD (나이) | ✅ 완료 |
| 국적 | 대한민국 등 | ✅ 완료 |
| 등록일 | 현장 최초 등록일 | ✅ 완료 |

### 5.3 채용 서류 (최대 10개)

| 서류 유형 | 코드 | 상태 |
|-----------|------|------|
| 안전관리서약서 | SAFETY_PLEDGE | ✅ 완료 |
| 교육이수및보호구수령확인서 | TRAINING_CERT | ✅ 완료 |
| 개인정보수집이용동의서 | PRIVACY_CONSENT | ✅ 완료 |
| 건강문진표 | HEALTH_QUESTIONNAIRE | ✅ 완료 |
| 기초안전보건교육증 | SAFETY_EDUCATION_CERT | ✅ 완료 |
| 자격증 | LICENSE | ✅ 완료 |
| 기타 | OTHER | ✅ 완료 |

### 5.4 비상연락처

| 항목 | 설명 | 상태 |
|------|------|------|
| 이름 | 비상연락처 대상자 | ✅ 완료 |
| 연락처 | 클릭 시 전화 연결 | ✅ 완료 |
| 관계 | 배우자, 부모, 자녀 등 | ✅ 완료 |

### 5.5 건강정보

| 항목 | 설명 | 상태 |
|------|------|------|
| 혈액형 | A, B, O, AB (Rh+/-) | ✅ 완료 |
| 하루 흡연량 | 개비 수 | ✅ 완료 |
| 1주일 음주횟수 | 횟수 | ✅ 완료 |
| 음주 1회 섭취량 | 예: 소주 1병 | ✅ 완료 |
| 최고혈압 | mmHg | ✅ 완료 |
| 최저혈압 | mmHg | ✅ 완료 |
| 65세 이상 여부 | 예/아니오 | ✅ 완료 |
| 기저질환 여부 | 있음/없음 | ✅ 완료 |

---

## 6. 데이터 모델

### 6.1 Worker (근로자)

```typescript
interface Worker {
  id: string;
  name: string;
  phone: string;
  birthDate: string;
  age?: number;
  isSenior?: boolean;
  siteId: number;
  teamId: number;
  teamName?: string;
  role: UserRole;
  position?: string;
  isRepresentative?: boolean;
  nationality?: string;
  gender?: 'M' | 'F';
  status: WorkerStatus;
  totalWorkDays?: number;
  monthlyWorkDays?: number;
  registeredAt?: string;
}
```

### 6.2 Team (팀/업체)

```typescript
interface Team {
  id: number;
  name: string;
  siteId: number;
  leaderId?: string;
  leaderName?: string;
  workerCount?: number;
}
```

---

## 7. 사용자 시나리오

### 시나리오 1: 대규모 인원 필터링

1. 현장에 100명 이상의 근로자가 등록됨
2. 파워 필터 바에서 "B업체(미장팀)" 선택
3. 마스터 테이블에 B업체 인원만 표시
4. 추가로 "승인대기" 상태 필터 적용
5. 승인 대기 중인 B업체 인원만 표시

### 시나리오 2: 일괄 팀 변경

1. 마스터 테이블에서 여러 명 체크박스 선택
2. 상단에 "N명 선택됨" 바 표시
3. [팀 변경] 버튼 클릭
4. 새 팀 선택하여 일괄 변경

### 시나리오 3: 신규 근로자 등록

1. [신규 동의링크] 버튼 클릭
2. 소속 팀, 이름, 연락처, 생년월일, 직책 입력 (직접 입력 가능)
3. 시스템 권한 선택 (일반 근로자 / 팀 관리자)
4. [동의링크 발송] 버튼 클릭
5. 근로자에게 문자로 동의 링크 발송
6. 목록에 '승인대기' 상태로 표시

### 시나리오 4: 엑셀 일괄 등록

1. [엑셀 일괄 등록] 버튼 클릭
2. 양식 다운로드 후 데이터 입력
3. 파일 드래그 앤 드롭으로 업로드
4. 검증 결과 미리보기 (정상/오류/중복 분류)
5. 오류 셀 직접 수정 후 재검증
6. 중복 데이터 처리 방식 선택 (업데이트/건너뛰기)
7. [등록 및 초대 발송] 버튼 클릭
8. 신규 등록 완료 및 SMS 일괄 발송

---

## 8. 구현 파일 목록

| 파일 | 설명 |
|------|------|
| `pages/WorkersPage.tsx` | 메인 목록 화면 (필터, 테이블) |
| `components/workers/WorkerAddModal.tsx` | 근로자 추가 팝업 |
| `components/workers/WorkerDetailModal.tsx` | 상세 정보 모달 (중앙 팝업) |
| `components/workers/WorkerExcelUploadModal.tsx` | 엑셀 일괄 등록 모달 |
| `@tong-pass/shared/types` | Worker, Team 타입 정의 |

---

## 9. 추후 구현 예정

- [ ] 문자 발송 API 연동
- [ ] 승인 상태 실시간 체크
- [ ] 서류 업로드 기능
- [ ] 근로자 수정/삭제 기능
- [ ] 팀 관리 (추가/수정/삭제)
- [ ] 일괄 편집 API 연동 (팀 변경, 비활성화)
- [ ] 무한 스크롤 옵션 (페이지네이션 대안)
- [ ] 팀 필터 검색 기능 (인원이 많을 경우)
- [ ] 엑셀 파싱 라이브러리 (xlsx) 연동
- [ ] Bulk Insert API 구현

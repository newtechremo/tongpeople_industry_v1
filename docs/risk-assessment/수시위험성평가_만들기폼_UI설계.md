# 수시 위험성평가 만들기 폼 UI 설계서

> **Version:** 1.0
> **작성일:** 2026.01.12
> **상태:** 설계 검토 중

---

## 1. 전체 흐름

### 1.1 Step 구성

```
┌─────────────────────────────────────────────────────────────────────┐
│  < 수시 위험성평가 만들기                                            │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│   ①────────②────────③────────④                                    │
│   기본정보    결재라인    위험요인    검토저장                         │
│   (현재)                                                            │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

| Step | 이름 | 필수 여부 | 설명 |
|:----:|------|:--------:|------|
| 1 | 기본 정보 | 필수 | 현장, 회사, 기간, 위험성수준 방법 |
| 2 | 결재라인 | 필수 | 템플릿 선택 |
| 3 | 위험요인 | 필수 | AI 추천 + 선택 |
| 4 | 검토/저장 | 필수 | 최종 확인 후 저장 |

### 1.2 Stepper 컴포넌트

```
활성 Step:     ●━━━━━━○━━━━━━○━━━━━━○
              기본정보  결재라인  위험요인  검토저장
              (orange) (gray)   (gray)   (gray)

완료 Step:     ✓━━━━━━●━━━━━━○━━━━━━○
              기본정보  결재라인  위험요인  검토저장
              (green)  (orange) (gray)   (gray)
```

**색상:**
- 완료: `bg-green-500` (체크 아이콘)
- 현재: `bg-orange-500` (숫자)
- 대기: `bg-gray-300` (숫자)

---

## 2. Step 1: 기본 정보

### 2.1 화면 레이아웃

```
┌─────────────────────────────────────────────────────────────────────┐
│  < 수시 위험성평가 만들기                                            │
├─────────────────────────────────────────────────────────────────────┤
│   ●━━━━━━○━━━━━━○━━━━━━○                                           │
│   기본정보  결재라인  위험요인  검토저장                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 기본 정보                                                    │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │                                                             │   │
│  │  평가 구분        ① 수시 위험성평가              (읽기전용)   │   │
│  │                                                             │   │
│  │  현장명          강서23 마포 삼성                 (읽기전용)   │   │
│  │                                                             │   │
│  │  소속 회사 *     [          입력하세요          ▼]           │   │
│  │                  └─ 드롭다운: 내 회사 목록                   │   │
│  │                                                             │   │
│  │  ─────────────────────────────────────────────────────────  │   │
│  │                                                             │   │
│  │  위험성 수준 방법 *                                          │   │
│  │                                                             │   │
│  │  ┌──────────────────┐  ┌──────────────────┐                │   │
│  │  │  ○ 상 / 중 / 하   │  │  ○ 빈도 × 강도   │                │   │
│  │  │                  │  │                  │                │   │
│  │  │  간편하게 3단계로  │  │  정밀하게 매트릭스 │                │   │
│  │  │  평가합니다       │  │  로 평가합니다    │                │   │
│  │  └──────────────────┘  └──────────────────┘                │   │
│  │                                                             │   │
│  │  ─────────────────────────────────────────────────────────  │   │
│  │                                                             │   │
│  │  작업 기간 *                                                 │   │
│  │                                                             │   │
│  │  시작일  [2026-01-15  📅]    종료일  [2026-01-31  📅]        │   │
│  │                                                             │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│                                           [취소]  [다음 →]          │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 필드 상세

| 필드 | 타입 | 필수 | 기본값 | 비고 |
|------|------|:----:|--------|------|
| 평가 구분 | 읽기전용 | - | "① 수시 위험성평가" | 이전 화면에서 선택됨 |
| 현장명 | 읽기전용 | - | 현재 대시보드 현장 | 변경 불가 |
| 소속 회사 | 드롭다운 | ✓ | - | 내가 속한 회사/협력사 목록 |
| 위험성 수준 | 라디오카드 | ✓ | 상중하 | 2가지 중 택1 |
| 시작일 | 날짜선택 | ✓ | 오늘 | DatePicker |
| 종료일 | 날짜선택 | ✓ | - | 시작일 이후만 선택 가능 |

### 2.3 위험성 수준 카드 디자인

```
┌─ 선택됨 ─────────────────┐  ┌─ 미선택 ────────────────┐
│ border-orange-500        │  │ border-gray-200        │
│ bg-orange-50             │  │ bg-white               │
│                          │  │                        │
│  ● 상 / 중 / 하           │  │  ○ 빈도 × 강도         │
│                          │  │                        │
│  🟢🟡🔴                   │  │  📊 4×5 매트릭스        │
│                          │  │                        │
│  간편하게 3단계로         │  │  정밀하게 점수로        │
│  평가합니다              │  │  평가합니다            │
│                          │  │                        │
└──────────────────────────┘  └────────────────────────┘
```

---

## 3. Step 2: 결재라인 선택

### 3.1 화면 레이아웃

```
┌─────────────────────────────────────────────────────────────────────┐
│  < 수시 위험성평가 만들기                                            │
├─────────────────────────────────────────────────────────────────────┤
│   ✓━━━━━━●━━━━━━○━━━━━━○                                           │
│   기본정보  결재라인  위험요인  검토저장                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 결재라인 선택                                                │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │                                                             │   │
│  │  결재라인 템플릿 *   [결재라인을 선택하세요              ▼]   │   │
│  │                                                             │   │
│  │  ─────────────────────────────────────────────────────────  │   │
│  │                                                             │   │
│  │  선택된 결재라인 미리보기:                                   │   │
│  │                                                             │   │
│  │  ┌──────────┬──────────┬──────────┬──────────┐             │   │
│  │  │ 근로자대표 │ 총괄책임자 │ 안전보건담당│ 현장소장   │             │   │
│  │  ├──────────┼──────────┼──────────┼──────────┤             │   │
│  │  │  이영희   │  박철수   │  김안전   │  최현장   │             │   │
│  │  │  (팀장)   │  (부장)   │  (차장)   │  (소장)   │             │   │
│  │  └──────────┴──────────┴──────────┴──────────┘             │   │
│  │                                                             │   │
│  │                     ───→ ───→ ───→                         │   │
│  │                       결재 진행 방향                         │   │
│  │                                                             │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ ⚠️ 결재라인이 없나요?                                        │   │
│  │                                                             │   │
│  │ 설정 > 결재라인 설정에서 템플릿을 먼저 만들어야 합니다.       │   │
│  │                                                             │   │
│  │                              [설정으로 이동]                 │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│                                    [← 이전]  [취소]  [다음 →]       │
└─────────────────────────────────────────────────────────────────────┘
```

### 3.2 결재라인 드롭다운

```
┌─────────────────────────────────────────────────────┐
│ 결재라인을 선택하세요                            ▼  │
├─────────────────────────────────────────────────────┤
│ ○ 위험성평가용 기본 결재라인                        │
│   근로자대표 → 총괄책임자 → 안전보건담당 → 현장소장  │
├─────────────────────────────────────────────────────┤
│ ○ 협력업체용 결재라인                              │
│   팀장 → 안전관리자 → 현장소장                      │
├─────────────────────────────────────────────────────┤
│ ○ 긴급 결재라인                                    │
│   안전관리자 → 현장소장                            │
└─────────────────────────────────────────────────────┘
```

### 3.3 결재라인 미리보기 테이블

| 단계 | 결재직책 | 결재자 | 직위 |
|:----:|---------|--------|------|
| 1 | 근로자대표 | 이영희 | 팀장 |
| 2 | 총괄책임자 | 박철수 | 부장 |
| 3 | 안전보건담당 | 김안전 | 차장 |
| 4 | 현장소장 | 최현장 | 소장 |

---

## 4. Step 3: 위험요인 선택 (핵심!)

### 4.1 전체 레이아웃

```
┌─────────────────────────────────────────────────────────────────────┐
│  < 수시 위험성평가 만들기                                            │
├─────────────────────────────────────────────────────────────────────┤
│   ✓━━━━━━✓━━━━━━●━━━━━━○                                           │
│   기본정보  결재라인  위험요인  검토저장                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌───────────────────────────────────────────────────────────────┐ │
│  │ 위험요인 검색 (AI 추천)                                        │ │
│  ├───────────────────────────────────────────────────────────────┤ │
│  │                                                               │ │
│  │  대분류 *     [건설업 - 건축                            ▼]    │ │
│  │              ┌────────────────────────────────────────┐      │ │
│  │              │ 건설업 - 토목                          │      │ │
│  │              │ 건설업 - 건축  ✓                       │      │ │
│  │              │ 건설업 - 플랜트                        │      │ │
│  │              │ 제조업                                 │      │ │
│  │              │ 기타                                   │      │ │
│  │              └────────────────────────────────────────┘      │ │
│  │                                                               │ │
│  │  키워드 *     [지게차, 운반, 적재                        ]    │ │
│  │              쉼표(,)로 구분하여 입력                          │ │
│  │                                                               │ │
│  │  추천 키워드:  [비계] [거푸집] [철근] [콘크리트] [용접]        │ │
│  │                                                               │ │
│  │                                        [🔍 AI 추천 검색]      │ │
│  └───────────────────────────────────────────────────────────────┘ │
│                                                                     │
│  ┌───────────────────────────────────────────────────────────────┐ │
│  │ 추천 결과 (47건)                          선택됨: 12건        │ │
│  ├───────────────────────────────────────────────────────────────┤ │
│  │  [☑️ 전체선택]  [🔽 점수순]  [필터: 고위험만 ▼]               │ │
│  ├───────────────────────────────────────────────────────────────┤ │
│  │                                                               │ │
│  │  ☑️ [98점] 지게차 운반작업                                    │ │
│  │     위험요인: 지게차 운행 중 후진 시 후방 확인 미흡으로...    │ │
│  │     재해형태: 🔴 끼임 (고위험)                                │ │
│  │     추천근거: 작업명 '지게차' 매칭(40) + 복합매칭 2개(30)...  │ │
│  │                                                               │ │
│  │  ☑️ [90점] 중량물 운반작업                                    │ │
│  │     위험요인: 중량물 운반 시 떨어짐 및 충돌 위험...           │ │
│  │     재해형태: 🔴 떨어짐 (고위험)                              │ │
│  │     추천근거: 작업명 '운반' 매칭(40) + 고위험 재해(30)        │ │
│  │                                                               │ │
│  │  ☐ [75점] 적재물 하역작업                                    │ │
│  │     위험요인: 적재물 하역 시 낙하로 인한 맞음 위험...         │ │
│  │     재해형태: 🟡 맞음                                        │ │
│  │     추천근거: 위험요인 '적재' 매칭(20) + 복합매칭(30)         │ │
│  │                                                               │ │
│  │  ... (스크롤)                                                │ │
│  │                                                               │ │
│  └───────────────────────────────────────────────────────────────┘ │
│                                                                     │
│                                    [← 이전]  [취소]  [다음 →]       │
└─────────────────────────────────────────────────────────────────────┘
```

### 4.2 AI 추천 결과 카드

```
┌─────────────────────────────────────────────────────────────────────┐
│ ☑️  [98점]  지게차 운반작업                                         │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  위험요인:  지게차 운행 중 후진 시 후방 확인 미흡으로 근로자와      │
│            충돌할 수 있음                                           │
│                                                                     │
│  재해형태:  🔴 끼임 (고위험)                                        │
│                                                                     │
│  ─────────────────────────────────────────────────────────────────  │
│  추천근거:  작업명 '지게차' 매칭(40) + 위험요인 '운반' 매칭(20)     │
│            + 고위험 '끼임'(30) + 복합매칭 2개(30) = 98점            │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 4.3 재해형태 뱃지

| 재해형태 | 고위험 | 색상 | 코드 |
|---------|:------:|------|------|
| 떨어짐 | ⚠️ | 🔴 빨강 | `bg-red-100 text-red-700` |
| 끼임 | ⚠️ | 🔴 빨강 | `bg-red-100 text-red-700` |
| 질식 | ⚠️ | 🔴 빨강 | `bg-red-100 text-red-700` |
| 화재폭발 | ⚠️ | 🔴 빨강 | `bg-red-100 text-red-700` |
| 부딪힘 | | 🟡 노랑 | `bg-yellow-100 text-yellow-700` |
| 그 외 | | ⬜ 회색 | `bg-gray-100 text-gray-700` |

### 4.4 필터 옵션

```
┌────────────────────────┐
│ 필터 선택           ▼  │
├────────────────────────┤
│ ○ 전체                 │
│ ○ 고위험만 (떨어짐,끼임..)│
│ ○ 80점 이상만          │
│ ○ 선택된 항목만        │
└────────────────────────┘
```

### 4.5 빈 상태 (검색 전)

```
┌───────────────────────────────────────────────────────────────┐
│                                                               │
│                         🔍                                    │
│                                                               │
│              대분류와 키워드를 입력하고                        │
│              [AI 추천 검색] 버튼을 클릭하세요                  │
│                                                               │
│              18,507건의 위험요인 DB에서                        │
│              최적의 항목을 추천해 드립니다                     │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

---

## 5. Step 4: 검토 및 저장

### 5.1 화면 레이아웃

```
┌─────────────────────────────────────────────────────────────────────┐
│  < 수시 위험성평가 만들기                                            │
├─────────────────────────────────────────────────────────────────────┤
│   ✓━━━━━━✓━━━━━━✓━━━━━━●                                           │
│   기본정보  결재라인  위험요인  검토저장                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 입력 내용 확인                                               │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │                                                             │   │
│  │  평가 구분       ① 수시 위험성평가                           │   │
│  │  현장명         강서23 마포 삼성                             │   │
│  │  소속 회사       (주)삼성건설                                │   │
│  │  위험성 수준     빈도 × 강도                                 │   │
│  │  작업 기간       2026-01-15 ~ 2026-01-31 (17일)             │   │
│  │                                                             │   │
│  │  ─────────────────────────────────────────────────────────  │   │
│  │                                                             │   │
│  │  결재라인:                                                   │   │
│  │  ┌──────────┬──────────┬──────────┬──────────┐             │   │
│  │  │ 근로자대표 │ 총괄책임자 │ 안전보건담당│ 현장소장   │             │   │
│  │  ├──────────┼──────────┼──────────┼──────────┤             │   │
│  │  │  이영희   │  박철수   │  김안전   │  최현장   │             │   │
│  │  └──────────┴──────────┴──────────┴──────────┘             │   │
│  │                                                             │   │
│  │  ─────────────────────────────────────────────────────────  │   │
│  │                                                             │   │
│  │  선택된 위험요인: 12건                                       │   │
│  │                                                             │   │
│  │  • 지게차 운반작업 - 끼임 🔴                                 │   │
│  │  • 중량물 운반작업 - 떨어짐 🔴                               │   │
│  │  • 적재물 하역작업 - 맞음 🟡                                 │   │
│  │  • ... 외 9건                              [전체보기 ▼]     │   │
│  │                                                             │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 💡 안내                                                      │   │
│  │                                                             │   │
│  │ • 임시 저장: 나중에 이어서 작성할 수 있습니다                │   │
│  │ • 결재 요청: 결재라인의 첫 번째 결재자에게 알림이 갑니다     │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│                      [← 이전]  [임시 저장]  [결재 요청]             │
└─────────────────────────────────────────────────────────────────────┘
```

### 5.2 버튼 동작

| 버튼 | 동작 | 결과 상태 |
|------|------|----------|
| 임시 저장 | DB 저장, 목록으로 이동 | `DRAFT` (작성중) |
| 결재 요청 | DB 저장, 첫 결재자에게 알림 | `PENDING` (결재대기) |
| 취소 | 확인 팝업 후 목록으로 이동 | - |

---

## 6. 반응형 고려사항

### 6.1 데스크톱 (1024px+)
- 2컬럼 레이아웃 가능
- 위험요인 카드 넓게 표시

### 6.2 태블릿 (768px ~ 1023px)
- 1컬럼 레이아웃
- Stepper 아이콘만 표시 (텍스트 숨김)

### 6.3 모바일 (< 768px)
- **지원하지 않음** (PC 전용)
- 모바일 접근 시 "PC에서 작성해 주세요" 안내

---

## 7. 상태 관리

### 7.1 폼 데이터 구조

```typescript
interface OccasionalAssessmentForm {
  // Step 1: 기본 정보
  assessmentType: 'OCCASIONAL';
  siteId: number;           // 현장 ID (자동)
  siteName: string;         // 현장명 (표시용)
  companyId: number;        // 소속 회사 ID
  riskLevelMethod: 'SIMPLE' | 'MATRIX';  // 상중하 / 빈도강도
  startDate: string;        // YYYY-MM-DD
  endDate: string;          // YYYY-MM-DD

  // Step 2: 결재라인
  approvalLineId: number;   // 결재라인 템플릿 ID

  // Step 3: 위험요인
  selectedRiskFactors: {
    id: number;
    taskName: string;
    riskFactor: string;
    accidentType: string;
    score: number;
  }[];

  // 검색 상태 (임시)
  searchCategory: string;
  searchKeywords: string[];
}
```

### 7.2 유효성 검사

| Step | 필드 | 검사 조건 |
|:----:|------|----------|
| 1 | 소속 회사 | 필수 선택 |
| 1 | 위험성 수준 | 필수 선택 |
| 1 | 시작일 | 필수, 오늘 이후 |
| 1 | 종료일 | 필수, 시작일 이후 |
| 2 | 결재라인 | 필수 선택 |
| 3 | 위험요인 | 최소 1개 이상 선택 |

---

## 8. 에러 처리

### 8.1 결재라인 없음

```
┌───────────────────────────────────────────────────┐
│                                                   │
│  ⚠️ 결재라인이 설정되어 있지 않습니다              │
│                                                   │
│  위험성평가를 작성하려면 먼저 결재라인을          │
│  설정해야 합니다.                                 │
│                                                   │
│            [설정으로 이동]  [취소]                │
│                                                   │
└───────────────────────────────────────────────────┘
```

### 8.2 AI 추천 결과 없음

```
┌───────────────────────────────────────────────────┐
│                                                   │
│                    😕                             │
│                                                   │
│  검색 결과가 없습니다                             │
│                                                   │
│  • 키워드를 더 일반적인 단어로 변경해 보세요      │
│  • 대분류를 변경해 보세요                         │
│                                                   │
│  예: "지게차" → "운반", "용접" → "화기작업"       │
│                                                   │
└───────────────────────────────────────────────────┘
```

---

## 9. 다음 단계

- [ ] UI 설계 검토 및 피드백
- [ ] 컴포넌트 구현
- [ ] API 연동
- [ ] 테스트

---

## 10. 참고 자료

| 문서 | 설명 |
|------|------|
| `위험성평가_기획서.md` | 전체 기능 기획 |
| `위험성평가_개발명세서.md` | 기술 상세 |
| `결재시스템_명세서.md` | 결재라인 설계 |
| `figma/*.png` | 상세보기 화면 참조 |

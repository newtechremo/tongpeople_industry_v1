# 작업 로그 - 2026.01.13

## 작업 브랜치
`feature/worker-signup`

---

## 1. 근로자 가입 PRD 문서 통합

### 작업 내용
- 기존 2개 문서를 1개로 통합
  - `현장통_근로자앱_PRD_v1.0.md` (삭제)
  - `현장통_근로자앱_가입플로우_v1_final.md` (삭제)
  - → `통패스_근로자앱_가입_PRD.md` (신규)

### 통합 시 수정 사항
- 서비스명 통일: 현장통 → 통패스(TongPass)
- 상태값 통일: `PENDING_APPROVAL` → `REQUESTED`
- 생년월일 필수 항목으로 추가 (8자리 YYYYMMDD)
- CLAUDE.md에 문서 참조 링크 추가

### 커밋
```
05be5a8 docs: 근로자 가입 PRD 문서 통합 및 CLAUDE.md 연동
```

---

## 2. QR 스캔 플랫폼 변경 및 웹-앱 연동 아키텍처

### 배경
- 기존: 관리자 웹에서 QR 스캔
- 변경: 모바일 앱에서 QR 스캔 (팀관리자 이상 권한)
- 이유: 물리적 현장 상황에서 모바일이 더 적합

### CLAUDE.md 변경 사항

#### 서비스 구성 수정
| 앱 | 변경 전 | 변경 후 |
|----|---------|---------|
| 관리자 웹 | 대시보드, **QR 스캔**, 현장 설정 | 대시보드, **근로자 관리(승인/선등록)**, 현장 설정 |
| 근로자 앱 | QR 생성, 출퇴근 확인 | **회사코드 가입**, QR 생성, 출퇴근 확인 |

#### 웹-앱 연동 아키텍처 추가
양방향 실시간 연동 (Supabase Realtime)

**웹 → 앱:**
| 액션 | 앱 반응 |
|------|---------|
| 가입 승인 | 승인대기 → 메인 화면 전환 |
| 수동 퇴근 | 출근 → 퇴근 상태 변경 |
| 근로자 차단 | 강제 로그아웃 |

**앱 → 웹:**
| 액션 | 웹 반응 |
|------|---------|
| QR 출근 스캔 | 대시보드 KPI 실시간 갱신 |
| QR 퇴근 스캔 | 퇴근율 갱신 |
| 사고 발생 등록 | 사고 KPI 갱신 + 알림 |
| 신규 가입 요청 | 근로자 목록 승인대기 뱃지 |

#### 고도화 영역 (추후 적용)
- 오프라인 큐
- Realtime 재연결 전략
- React Query 캐시 무효화

### 커밋
```
fc26d3e docs: QR 스캔 플랫폼 변경 및 웹-앱 연동 아키텍처 추가
```

---

## 3. 가입 방식 A/B 입력 항목 통일화

### 배경
- 방식 A(선등록)와 방식 B(직접가입) 간 입력 항목 차이로 인한 데이터 불일치 우려
- 방식 B에서 팀/직책이 누락되면 대시보드 통계, 권한 검증 등에 문제 발생

### 변경 전
| 항목 | 방식 A | 방식 B |
|------|:------:|:------:|
| 소속 팀 | O (관리자 지정) | X (승인 시 지정) |
| 직책/직종 | O | X |

### 변경 후
| 항목 | 방식 A | 방식 B | 비고 |
|------|:------:|:------:|------|
| 소속 팀 | O (관리자 지정) | **O (앱에서 선택)** | 통일됨 |
| 직책/직종 | O | **O (앱에서 입력)** | 통일됨 |
| 시스템 권한 | O (선택 가능) | X (WORKER 고정) | 유일한 차이점 |

### 개선 효과
- 관리자 승인 시 팀/직책 지정 불필요 → 승인/반려만 처리
- 데이터 일관성 확보
- 대시보드 통계 누락 방지

### 수정 파일
1. `docs/signin/통패스_근로자앱_가입_PRD.md`
   - 방식 B 입력 항목에 소속팀, 직책/직종 추가
   - 비교표 업데이트
   - 와이어프레임에 팀 선택, 직책 입력 필드 추가
   - API 요청에 `teamId`, `jobTitle` 필드 추가
   - DB 스키마에 `job_title` 컬럼 추가

2. `CLAUDE.md`
   - 핵심 요약에 입력 항목 통일 명시

### 커밋
```
5b66cea docs: 가입 방식 A/B 입력 항목 통일화
```

---

## 커밋 히스토리 요약

```
5b66cea docs: 가입 방식 A/B 입력 항목 통일화
fc26d3e docs: QR 스캔 플랫폼 변경 및 웹-앱 연동 아키텍처 추가
05be5a8 docs: 근로자 가입 PRD 문서 통합 및 CLAUDE.md 연동
```

---

## 다음 작업 예정

1. **타입 정의 추가**: `packages/shared`에 `REQUESTED`, `BLOCKED` 상태 타입 반영
2. **승인 UI 구현**: 관리자 웹에서 REQUESTED 상태 근로자 승인/반려 모달
3. **모바일 앱 가입 플로우**: 팀 선택 + 직책 입력 화면 구현
4. **Realtime 연동**: 웹-앱 양방향 실시간 동기화 구현
